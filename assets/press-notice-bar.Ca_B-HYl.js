import{u as t,U as s,W as e,_ as o,x as a,l as n,y as i,ad as l,A as r,i as c,c as d,k as u,z as h,q as m,g as p,n as y,e as b,j as f,t as C,F as k,w as g,r as w,bb as I,o as _,d as S}from"./index-dUtMVM0l.js";const x={rootStyle:function(s){return t({color:s.color,"background-color":s.backgroundColor,background:s.background})}};const $=o({name:"PressNoticeBar",options:{...i,styleIsolation:"shared"},components:{PressIconPlus:n},props:{text:{type:String,default:""},mode:{type:String,default:""},url:{type:String,default:""},openType:{type:String,default:"navigate"},delay:{type:Number,default:1},speed:{type:Number,default:60},scrollable:{type:Boolean,default:!1},leftIcon:{type:String,default:""},color:{type:String,default:""},backgroundColor:{type:String,default:""},background:{type:String,default:""},wrapable:Boolean,...a},emits:["close","click"],data:()=>({show:!0,duration:0,animationDuration:0,contentWidth:0,translateX:0,isNotInUni:c()}),computed:{noticeBarClass(){const{mode:t,wrapable:s,customClass:e}=this;return`${e} ${r.bem2("notice-bar",{withicon:t,wrapable:s})}`},noticeBarStyle(){const{color:t,backgroundColor:s,background:e}=this;return x.rootStyle({color:t,backgroundColor:s,background:e})},animationStyle(){const{animationDuration:t,delay:s,translateX:e}=this;return[`transform: translateX(${e}px);`,`transition: -webkit-transform ${t}ms linear ${s}ms, transform ${t}ms linear ${s}ms;`,"transform-origin: 50% 50% 0px;"].join(" ")},leftIconClass:()=>"press-notice-bar__left-icon",leftIconCustomClass:()=>"",rightIconClass:()=>"press-notice-bar__right-icon",rightIconCustomClass:()=>""},watch:{text:{handler(){this.init()}},speed:{handler(){this.init()}}},created(){},mounted(){this.init()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){this.timer&&clearTimeout(this.timer)},init(){const{speed:t,scrollable:o}=this;(function({contentSelect:t=".press-notice-bar__content",wrapSelector:o=".press-notice-bar__wrap",context:a,speed:n=60,scrollable:i=!0}){return new Promise(((l,r)=>{s((()=>{Promise.all([e(a,t),e(a,o)]).then((t=>{const[s,e]=t;if(null!=s&&null!=e&&s.width&&e.width&&!1!==i){if(i||e.width<s.width){const t=(e.width+s.width)/n*1e3;l({wrapWidth:e.width,contentWidth:s.width,duration:t})}}else r()})).catch((t=>{r(t)}))}))}))})({contentSelect:".press-notice-bar__content",wrapSelector:".press-notice-bar__wrap",context:this,speed:t,scrollable:o}).then((({wrapWidth:t,contentWidth:s,duration:e})=>{this.wrapWidth=t,this.contentWidth=s,this.duration=e,this.scroll(!0)})).catch((()=>{}))},scroll(t=!1){this.timer&&clearTimeout(this.timer),this.timer=null,this.translateX=t?0:this.wrapWidth,this.animationDuration=0,s((()=>{this.translateX=-this.contentWidth,this.animationDuration=this.duration})),this.timer=setTimeout((()=>{this.scroll()}),this.duration)},onClickIcon(t){"closeable"===this.mode&&(this.timer&&clearTimeout(this.timer),this.timer=null,this.show=!1,this.$emit("close",l(t)))},onClick(t){this.$emit("click",t)}}},[["render",function(t,s,e,o,a,n){const i=w("PressIconPlus"),l=I;return _(),d("div",{class:"press-notice-bar-index"},[a.show?(_(),d("div",{key:0,class:m(n.noticeBarClass),style:h(n.noticeBarStyle),onClick:s[0]||(s[0]=(...t)=>n.onClick&&n.onClick(...t))},[e.leftIcon?(_(),p(i,{key:0,name:e.leftIcon,class:m([n.leftIconClass]),"custom-class":n.leftIconCustomClass},null,8,["name","class","custom-class"])):y(t.$slots,"left-icon",{key:1},void 0,!0),b("div",{class:"press-notice-bar__wrap"},[b("div",{class:m("press-notice-bar__content "+(!1!==e.scrollable||e.wrapable?"":"press-ellipsis")),style:h(n.animationStyle)},[f(C(e.text)+" ",1),e.text?u("",!0):y(t.$slots,"default",{key:0},void 0,!0)],6)]),"closeable"===e.mode?(_(),p(i,{key:2,class:m([n.rightIconClass]),"custom-class":n.rightIconCustomClass,name:"cross",onClick:n.onClickIcon},null,8,["class","custom-class","onClick"])):"link"===e.mode?(_(),d(k,{key:3},[a.isNotInUni?(_(),p(i,{key:0,class:m([n.rightIconClass]),"custom-class":n.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])):(_(),p(l,{key:1,url:e.url,"open-type":e.openType},{default:g((()=>[S(i,{class:m([n.rightIconClass]),"custom-class":n.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])])),_:1},8,["url","open-type"]))],64)):y(t.$slots,"right-icon",{key:4},void 0,!0)],6)):u("",!0)])}],["__scopeId","data-v-2a222cfa"]]);export{$ as P};
