import{a as t}from"./rect.NULosufi.js";import{a as e}from"./unit.DndLYDir.js";import{_ as s,ae as a,u as i,E as n,c as o,e as u,B as r,q as h,k as l,I as d,n as c,o as m}from"./index-Ca5qPapH.js";import{t as p}from"./touch.B3xmXKM9.js";const g=s({name:"PressSlider",mixins:[p],props:{range:Boolean,disabled:Boolean,useButtonSlot:Boolean,activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},max:{type:Number,default:100},min:{type:Number,default:0},step:{type:Number,default:1},value:{type:null,default:0},vertical:{type:Boolean,default:!1},barHeight:{type:[Number,String],default:""},customClass:{type:String,default:""},customStyle:{type:[String,Object],default:""}},emits:["drag-start","drag-end","drag","change"],data(){return{utils:n,style:i,barStyle:"",dataValue:this.value}},computed:{wrapStyle(){return i(this.customStyle)}},watch:{value:{handler(t){t!==this.dataValue&&this.updateValue(t)}}},created(){this.updateValue(this.value)},methods:{onTouchStart(t){if(this.disabled)return;const{index:e}=t.currentTarget.dataset;"number"!=typeof e&&"string"!=typeof e||(this.buttonIndex=+e),this.touchStart(t),this.startValue=this.format(this.dataValue),this.newValue=this.dataValue,this.isRange(this.newValue)?this.startValue=this.newValue.map((t=>this.format(t))):this.startValue=this.format(this.newValue),this.dragStatus="start"},onTouchMove(e){this.disabled||("start"===this.dragStatus&&this.$emit("drag-start"),this.touchMove(e),this.dragStatus="draging",t(this,".press-slider").then((t=>{const{vertical:e}=this,s=(e?this.deltaY:this.deltaX)/(e?t.height:t.width)*this.getRange();this.isRange(this.startValue)?this.newValue[this.buttonIndex]=this.startValue[this.buttonIndex]+s:this.newValue=this.startValue+s,this.updateValue(this.newValue,!1,!0)})))},onTouchEnd(){this.disabled||"draging"===this.dragStatus&&(this.updateValue(this.newValue,!0),this.$emit("drag-end"))},onClick(e){if(this.disabled)return;const{min:s}=this;t(this,".press-slider").then((t=>{const{vertical:a}=this,i=e.touches?e.touches[0]:e,n=a?i.clientY-t.top:i.clientX-t.left,o=a?t.height:t.width,u=Number(s)+n/o*this.getRange();if(this.isRange(this.dataValue)){const[t,e]=this.dataValue;u<=(t+e)/2?this.updateValue([u,e],!0):this.updateValue([t,u],!0)}else this.updateValue(u,!0)}))},isRange(t){const{range:e}=this;return e&&Array.isArray(t)},handleOverlap:t=>t[0]>t[1]?t.slice(0).reverse():t,updateValue(t,s,i){t=this.isRange(t)?this.handleOverlap(t).map((t=>this.format(t))):this.format(t),this.dataValue=t;const{vertical:n}=this,o=n?"height":"width";this.wrapperStyle=`\n          background: ${this.inactiveColor||""};\n          ${n?"width":"height"}: ${e(this.barHeight)||""};\n        `,this.barStyle=`\n          ${o}: ${this.calcMainAxis()};\n          left: ${n?0:this.calcOffset()};\n          top: ${n?this.calcOffset():0};\n          ${i?"transition: none;":""}\n        `,i&&this.$emit("drag",t),s&&this.$emit("change",t),(i||s)&&a()},getScope(){return Number(this.max)-Number(this.min)},getRange(){const{max:t,min:e}=this;return t-e},calcMainAxis(){const{dataValue:t}=this,{min:e}=this,s=this.getScope();return this.isRange(t)?100*(t[1]-t[0])/s+"%":100*(t-Number(e))/s+"%"},calcOffset(){const{dataValue:t}=this,{min:e}=this,s=this.getScope();return this.isRange(t)?100*(t[0]-Number(e))/s+"%":"0%"},format(t){const{max:e,min:s,step:a}=this;return Math.round(Math.max(s,Math.min(t,e))/a)*a}}},[["render",function(t,e,s,a,i,n){return m(),o("div",{class:"press-slider-index",style:r(n.wrapStyle)},[u("div",{class:h(s.customClass+" "+i.utils.bem2("slider",{disabled:s.disabled,vertical:s.vertical})),style:r(t.wrapperStyle),onClick:e[12]||(e[12]=(...t)=>n.onClick&&n.onClick(...t))},[u("div",{class:h([i.utils.bem2("slider__bar")]),style:r(i.barStyle+"; "+i.style({backgroundColor:s.activeColor}))},[s.range?(m(),o("div",{key:0,class:h([i.utils.bem2("slider__button-wrapper-left")]),"data-index":0,onTouchstart:e[0]||(e[0]=(...t)=>n.onTouchStart&&n.onTouchStart(...t)),onTouchmove:e[1]||(e[1]=d(((...t)=>n.onTouchMove&&n.onTouchMove(...t)),["stop","prevent"])),onTouchend:e[2]||(e[2]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t)),onTouchcancel:e[3]||(e[3]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t))},[s.useButtonSlot?c(t.$slots,"left-button",{key:0},void 0,!0):(m(),o("div",{key:1,class:h([i.utils.bem2("slider__button")])},null,2))],34)):l("",!0),s.range?(m(),o("div",{key:1,class:h([i.utils.bem2("slider__button-wrapper-right")]),"data-index":1,onTouchstart:e[4]||(e[4]=(...t)=>n.onTouchStart&&n.onTouchStart(...t)),onTouchmove:e[5]||(e[5]=d(((...t)=>n.onTouchMove&&n.onTouchMove(...t)),["stop","prevent"])),onTouchend:e[6]||(e[6]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t)),onTouchcancel:e[7]||(e[7]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t))},[s.useButtonSlot?c(t.$slots,"right-button",{key:0},void 0,!0):(m(),o("div",{key:1,class:h([i.utils.bem2("slider__button")])},null,2))],34)):l("",!0),s.range?l("",!0):(m(),o("div",{key:2,class:h([i.utils.bem2("slider__button-wrapper")]),onTouchstart:e[8]||(e[8]=(...t)=>n.onTouchStart&&n.onTouchStart(...t)),onTouchmove:e[9]||(e[9]=d(((...t)=>n.onTouchMove&&n.onTouchMove(...t)),["stop","prevent"])),onTouchend:e[10]||(e[10]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t)),onTouchcancel:e[11]||(e[11]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t))},[s.useButtonSlot?c(t.$slots,"button",{key:0},void 0,!0):(m(),o("div",{key:1,class:h([i.utils.bem2("slider__button")])},null,2))],34))],6)],6)],4)}],["__scopeId","data-v-d32ab355"]]);export{g as P};
