import{u as t,Y as s,_ as e,x as o,l as a,z as n,aj as i,E as r,i as l,c,k as d,B as u,q as h,g as m,n as p,e as y,j as b,t as f,F as C,w as k,r as g,be as w,o as I,d as _}from"./index-DXY-0Hyq.js";import{a as S}from"./rect.LLhLj8vX.js";const x={rootStyle:function(s){return t({color:s.color,"background-color":s.backgroundColor,background:s.background})}};const $=e({name:"PressNoticeBar",options:{...n,styleIsolation:"shared"},components:{PressIcon:a},props:{text:{type:String,default:""},mode:{type:String,default:""},url:{type:String,default:""},openType:{type:String,default:"navigate"},delay:{type:Number,default:1},speed:{type:Number,default:60},scrollable:{type:Boolean,default:!1},leftIcon:{type:String,default:""},color:{type:String,default:""},backgroundColor:{type:String,default:""},background:{type:String,default:""},wrapable:Boolean,...o},emits:["close","click"],data:()=>({show:!0,duration:0,animationDuration:0,contentWidth:0,translateX:0,isNotInUni:l()}),computed:{noticeBarClass(){const{mode:t,wrapable:s,customClass:e}=this;return`${e} ${r.bem2("notice-bar",{withicon:t,wrapable:s})}`},noticeBarStyle(){const{color:t,backgroundColor:s,background:e}=this;return x.rootStyle({color:t,backgroundColor:s,background:e})},animationStyle(){const{animationDuration:t,delay:s,translateX:e}=this;return[`transform: translateX(${e}px);`,`transition: -webkit-transform ${t}ms linear ${s}ms, transform ${t}ms linear ${s}ms;`,"transform-origin: 50% 50% 0px;"].join(" ")},leftIconClass:()=>"press-notice-bar__left-icon",leftIconCustomClass:()=>"",rightIconClass:()=>"press-notice-bar__right-icon",rightIconCustomClass:()=>""},watch:{text:{handler(){this.init()}},speed:{handler(){this.init()}}},created(){},mounted(){this.init()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){this.timer&&clearTimeout(this.timer)},init(){const{speed:t,scrollable:e}=this;(function({contentSelect:t=".press-notice-bar__content",wrapSelector:e=".press-notice-bar__wrap",context:o,speed:a=60,scrollable:n=!0}){return new Promise(((i,r)=>{s((()=>{Promise.all([S(o,t),S(o,e)]).then((t=>{const[s,e]=t;if(null!=s&&null!=e&&s.width&&e.width&&!1!==n){if(n||e.width<s.width){const t=(e.width+s.width)/a*1e3;i({wrapWidth:e.width,contentWidth:s.width,duration:t})}}else r()})).catch((t=>{r(t)}))}))}))})({contentSelect:".press-notice-bar__content",wrapSelector:".press-notice-bar__wrap",context:this,speed:t,scrollable:e}).then((({wrapWidth:t,contentWidth:s,duration:e})=>{this.wrapWidth=t,this.contentWidth=s,this.duration=e,this.scroll(!0)})).catch((()=>{}))},scroll(t=!1){this.timer&&clearTimeout(this.timer),this.timer=null,this.translateX=t?0:this.wrapWidth,this.animationDuration=0,s((()=>{this.translateX=-this.contentWidth,this.animationDuration=this.duration})),this.timer=setTimeout((()=>{this.scroll()}),this.duration)},onClickIcon(t){"closeable"===this.mode&&(this.timer&&clearTimeout(this.timer),this.timer=null,this.show=!1,this.$emit("close",i(t)))},onClick(t){this.$emit("click",t)}}},[["render",function(t,s,e,o,a,n){const i=g("PressIcon"),r=w;return I(),c("div",{class:"press-notice-bar-index"},[a.show?(I(),c("div",{key:0,class:h(n.noticeBarClass),style:u(n.noticeBarStyle),onClick:s[0]||(s[0]=(...t)=>n.onClick&&n.onClick(...t))},[e.leftIcon?(I(),m(i,{key:0,name:e.leftIcon,class:h([n.leftIconClass]),"custom-class":n.leftIconCustomClass},null,8,["name","class","custom-class"])):p(t.$slots,"left-icon",{key:1},void 0,!0),y("div",{class:"press-notice-bar__wrap"},[y("div",{class:h("press-notice-bar__content "+(!1!==e.scrollable||e.wrapable?"":"press-ellipsis")),style:u(n.animationStyle)},[b(f(e.text)+" ",1),e.text?d("",!0):p(t.$slots,"default",{key:0},void 0,!0)],6)]),"closeable"===e.mode?(I(),m(i,{key:2,class:h([n.rightIconClass]),"custom-class":n.rightIconCustomClass,name:"cross",onClick:n.onClickIcon},null,8,["class","custom-class","onClick"])):"link"===e.mode?(I(),c(C,{key:3},[a.isNotInUni?(I(),m(i,{key:0,class:h([n.rightIconClass]),"custom-class":n.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])):(I(),m(r,{key:1,url:e.url,"open-type":e.openType},{default:k((()=>[_(i,{class:h([n.rightIconClass]),"custom-class":n.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])])),_:1},8,["url","open-type"]))],64)):p(t.$slots,"right-icon",{key:4},void 0,!0)],6)):d("",!0)])}],["__scopeId","data-v-e01675a5"]]);export{$ as P};
