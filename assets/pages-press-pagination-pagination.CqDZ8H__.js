import{_ as e,W as t,H as o,i as s,G as n,c as l,k as r,d as a,w as i,q as c,S as p,r as u,o as h,F as d,f as g,e as m,t as f,l as y,P,bd as x,j as C}from"./index-_6p3YC47.js";import{i as T,a as S}from"./rect.DB3WpuNX.js";import{P as v}from"./press-popover-plus.Bq5s2QIm.js";import{P as b}from"./press-picker-plus.DMGWCm27.js";import{s as k,a as _,F as I}from"./helper.CjFb8We4.js";import"./click-outside.D9wL09rA.js";let w=null;const B=e({name:"PressPagination",options:{...o(!0,!1),styleIsolation:"shared"},components:{PressPopoverPlus:v},mixins:[t],props:{total:{type:Number,default:0},current:{type:Number,default:0},expand:{type:Boolean,default:!1},tipTemplate:{type:String,default:"第{{0}}页"},autoScroll:{type:Number,default:1},safeAreaInsetBottom:{type:Boolean,default:!0},customClass:{type:String,default:""},mode:{type:String,default:""}},emits:["change"],data:()=>({innerCurrent:0,scrollToView:"",tipOffset:0,selectedEvent:!1,zonesBox:{},scrollTop:0,old:{scrollTop:0}}),computed:{pageList(){return Array.from({length:this.total}).map(((e,t)=>t+1))},tipStyle(){return`top: ${this.tipOffset}px;bottom: unset;right: 50px;width: max-content;left: auto;transform: translateY(-50%);line-height: 16px;min-width: 42px;`},pageTip(){return this.tipTemplate.replace("{{0}}",this.innerCurrent)}},watch:{current:{handler(e){const t=this.pageList.findIndex((t=>t===e));this.innerCurrent=t>-1?this.pageList[t]:this.pageList[0],n((()=>{this.scrollTo()}))},immediate:!0},total:{handler(){n((()=>{this.getScrollBarSize()}))}},mode:{handler(){n((()=>{this.getScrollBarSize()}))}}},mounted(){this.selectedEvent=!1,this.getScrollBarSize()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},updated(){n((()=>{this.updatePopoverTipPosition()}))},methods:{onDestroyed(){this.selectedEvent=!1,w&&(clearTimeout(w),w=null)},getScrollBarSize(){S(this,".press-scrollbar").then((e=>{e&&(this.zonesBox={top:e.top,bottom:e.bottom,height:e.height})}))},updatePopoverTipPosition(){S(this,`#seq-${this.innerCurrent}`).then((e=>{e&&(this.tipOffset=e.top-this.zonesBox.top+e.height/2)}))},scroll(e){s()?this.old.scrollTop=e.target.scrollTop:this.old.scrollTop=e.detail.scrollTop,this.updatePopoverTipPosition()},scrollTo(){const{autoScroll:e}=this;this.scrollToView=`seq-${this.innerCurrent}`,this.scrollTop=this.old.scrollTop,Promise.all([T(this,"#zoneBox"),S(this,`#seq-${this.innerCurrent}`)]).then((([t,o])=>{if(!o)return;const{top:s,bottom:n,height:l=0}=this.zonesBox;if(l>0){if(o.top-s<e*o.height)this.scrollTop=Math.max(1,(this.innerCurrent-1-e)*o.height);else if(n-o.bottom<e*o.height){const s=(this.innerCurrent+e)*o.height-l;this.scrollTop=Math.min(s,t.scrollHeight-l)}this.updatePopoverTipPosition()}}))},handleSelect(e){w&&(clearTimeout(w),w=null),this.selectedEvent=!0,this.innerCurrent!==e&&(this.innerCurrent=e,this.$emit("change",e)),this.scrollTo(),w=setTimeout((()=>{this.selectedEvent=!1}),500)}}},[["render",function(e,t,o,s,n,y){const P=p,x=u("PressPopoverPlus");return h(),l("div",{class:c(["press-pagination",[o.customClass,{"press-pagination--safe":o.safeAreaInsetBottom},{"press-pagination--hor":"hor"===o.mode}]])},[y.pageList.length>1?(h(),l("div",{key:0,class:"press-pagination__wrap"},[a(P,{id:"zoneBox",class:c(["press-scrollbar","press-scrollbar--active"]),"scroll-y":"true","scroll-with-animation":"","enable-flex":!0,"scroll-top":n.scrollTop,onScroll:y.scroll},{default:i((()=>[(h(!0),l(d,null,g(y.pageList,((e,t)=>(h(),l("div",{id:"seq-"+e,key:t,class:c(["press-scrollbar__scale",[{"press-scrollbar__scale--selected":n.innerCurrent===e},`press-scrollbar__scale--total-${o.total}`]]),onClick:o=>y.handleSelect(e,t)},[m("span",null,f(e),1)],10,["id","onClick"])))),128))])),_:1},8,["scroll-top","onScroll"]),a(x,{show:n.selectedEvent,placement:"left","custom-style":y.tipStyle},{default:i((()=>[m("p",null,f(y.pageTip),1)])),_:1},8,["show","custom-style"])])):r("",!0)],2)}],["__scopeId","data-v-d6128d17"]]),L={pageTotal:30,current:2,expand:!1},N=Array.from({length:4}).map(((e,t)=>10**t)).reduce(((e,t)=>{for(let o=1;o<10;o++)e.push(t*o);return e}),[]).map((e=>({label:e,value:e})));const z=e({i18n:{"zh-CN":{title2:"简单模式",title3:"显示省略号",title4:"自定义按钮",prevText:"上一页",nextText:"下一页"},"en-US":{title2:"Simple Mode",title3:"Show ellipses",title4:"Custom Button",prevText:"Prev",nextText:"Next"}},components:{PressPagination:B,PressPopupCell:x,PressPickerPlus:b,PressCell:P,PressIcon:y},data(){const e={...L};return{sectionStyle:"margin: 0;background: #f7f8fa;",backgroundStyle:"background: #f7f8fa;",FUNCTIONAL_ID_MAP:I,mode:"",componentConfig:e,currentPage1:1,currentPage2:1,currentPage3:1,currentPage4:1}},methods:{onShowBasicPopupCell(){const{pageTotal:e,current:t}=this.componentConfig;!function({context:e,callback:t,pageTotal:o,current:s,isHor:n}){k({context:e,title:"自定义设置",closeIcon:!0,cellList:[{label:"页面数",value:o,click:({context:s})=>{s.closeDialog(),_({title:"页面数",closeIcon:!0,list:N,current:{value:o},context:e}).then((({item:o})=>{L.pageTotal=o.value,e.onGTip("设置成功"),"function"==typeof t.changePageTotal&&t.changePageTotal.call(e,o.value)})).catch((()=>{}))}},{label:"当前页",value:s,click:({context:n})=>{n.closeDialog(),_({title:"当前页",closeIcon:!0,list:N.filter((e=>e.value<=o)),current:{value:s},context:e}).then((({item:o})=>{L.current=o.value,e.onGTip("设置成功"),"function"==typeof t.changeCurrent&&t.changeCurrent.call(e,o.value)})).catch((()=>{}))}},{label:"是否为Hor模式",type:"switch",open:n,click:({context:o})=>{o.closeDialog(),e.onGTip("设置成功"),"function"==typeof t.changeHor&&t.changeHor.call(e,!n)}}]})}({context:this,callback:{changePageTotal:this.changePageTotal,changeCurrent:this.changeCurrent,changeHor:this.changeHor},pageTotal:e,current:t,isHor:"hor"===this.mode})},changeExpand(e){this.componentConfig={...this.componentConfig,expand:e}},changePageTotal(e){this.componentConfig={...this.componentConfig,pageTotal:e},this.componentConfig.current>e&&(this.componentConfig.current=e)},changeCurrent(e){this.componentConfig={...this.componentConfig,current:e}},changeHor(e){this.mode=e?"hor":""},onChange(e){console.log("[onChange]",e),this.componentConfig.current=e}}},[["render",function(e,t,o,s,n,r){const c=u("PressPagination"),p=u("demo-block"),d=u("PressIcon"),g=u("PressCell"),m=u("PressPopupCell"),y=u("PressPickerPlus");return h(),l("div",{class:"demo-wrap demo-wrap--gray"},[a(p,{title:e.t("basicUsage"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[a(c,{current:n.currentPage1,mode:"multi","total-items":24,"items-per-page":5,"prev-text":e.t("prevText"),"next-text":e.t("nextText"),onChange:t[0]||(t[0]=e=>n.currentPage1=e)},null,8,["current","prev-text","next-text"])])),_:1},8,["title","section-style","header-style","custom-style"]),a(p,{title:e.t("title2"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[a(c,{current:n.currentPage2,total:12,"prev-text":e.t("prevText"),"next-text":e.t("nextText"),mode:"simple",size:"small",onChange:t[1]||(t[1]=e=>n.currentPage2=e)},null,8,["current","prev-text","next-text"])])),_:1},8,["title","section-style","header-style","custom-style"]),a(p,{title:e.t("title3"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[a(c,{mode:"multi",current:n.currentPage3,"force-ellipses":"","total-items":125,"show-page-size":3,"prev-text":e.t("prevText"),"next-text":e.t("nextText"),onChange:t[2]||(t[2]=e=>n.currentPage3=e)},null,8,["current","prev-text","next-text"])])),_:1},8,["title","section-style","header-style","custom-style"]),a(p,{title:e.t("title4"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[a(c,{mode:"multi",current:n.currentPage4,"total-items":125,"show-page-size":5,onChange:t[3]||(t[3]=e=>n.currentPage4=e)},{"prev-text":i((()=>[a(d,{name:"arrow-left"})])),"next-text":i((()=>[a(d,{name:"arrow"})])),page:i((({text:e})=>[C(f(e),1)])),_:1},8,["current"])])),_:1},8,["title","section-style","header-style","custom-style"]),a(p,{title:"E-Sport","section-style":n.sectionStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[a(g,{title:e.t("custom"),"is-link":"",onClick:r.onShowBasicPopupCell},null,8,["title","onClick"])])),_:1},8,["section-style","header-style","custom-style"]),a(m,{id:n.FUNCTIONAL_ID_MAP.POPUP_CELL,ref:n.FUNCTIONAL_ID_MAP.POPUP_CELL,mode:"functional"},null,8,["id"]),a(y,{id:n.FUNCTIONAL_ID_MAP.PICKER,ref:n.FUNCTIONAL_ID_MAP.PICKER,mode:"functional"},null,8,["id"]),a(c,{total:n.componentConfig.pageTotal,current:n.componentConfig.current,expand:n.componentConfig.expand,mode:n.mode,onChange:r.onChange},null,8,["total","current","expand","mode","onChange"])])}]]);export{z as default};
