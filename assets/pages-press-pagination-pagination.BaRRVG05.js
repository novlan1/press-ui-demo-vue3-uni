import{_ as e,W as t,H as o,i as s,G as n,c as l,k as a,d as r,w as i,q as c,S as p,r as u,o as h,F as d,f as m,e as g,t as x,bi as f,b4 as P,I as y,n as C,j as b,g as v,l as T,P as S,bd as k}from"./index-Mrykku7M.js";import{i as _,a as w}from"./rect.B8U24y-o.js";import{P as I}from"./press-popover-plus.B0Rx5g5D.js";import{P as B}from"./press-picker-plus.azfdqODQ.js";import{s as N,a as z,F as E}from"./helper.xszN3jmi.js";import"./click-outside.D9wL09rA.js";const L={mode:{type:String,default:""},total:{type:Number,default:0},current:{type:Number,default:0},customClass:{type:String,default:""}},M={prevText:{type:String,default:"上一页"},nextText:{type:String,default:"下一页"},totalItems:{type:Number,default:0},showPageSize:{type:Number,default:5},itemsPerPage:{type:Number,default:10},forceEllipses:{type:Boolean,default:!1},showPrevButton:{type:Boolean,default:!0},showNextButton:{type:Boolean,default:!0}},$={expand:{type:Boolean,default:!1},tipTemplate:{type:String,default:"第{{0}}页"},autoScroll:{type:Number,default:1},safeAreaInsetBottom:{type:Boolean,default:!0}};let A=null;const D=e({name:"PressPagination",options:{...o(!0,!1),styleIsolation:"shared"},components:{PressPopoverPlus:I},mixins:[t],props:{...$,...L},emits:["change"],data:()=>({innerCurrent:0,scrollToView:"",tipOffset:0,selectedEvent:!1,zonesBox:{},scrollTop:0,old:{scrollTop:0}}),computed:{pageList(){return Array.from({length:this.total}).map(((e,t)=>t+1))},tipStyle(){return`top: ${this.tipOffset}px;bottom: unset;right: 50px;width: max-content;left: auto;transform: translateY(-50%);line-height: 16px;min-width: 42px;`},pageTip(){return this.tipTemplate.replace("{{0}}",this.innerCurrent)}},watch:{current:{handler(e){const t=this.pageList.findIndex((t=>t===e));this.innerCurrent=t>-1?this.pageList[t]:this.pageList[0],n((()=>{this.scrollTo()}))},immediate:!0},total:{handler(){n((()=>{this.getScrollBarSize()}))}},mode:{handler(){n((()=>{this.getScrollBarSize()}))}}},mounted(){this.selectedEvent=!1,this.getScrollBarSize()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},updated(){n((()=>{this.updatePopoverTipPosition()}))},methods:{onDestroyed(){this.selectedEvent=!1,A&&(clearTimeout(A),A=null)},getScrollBarSize(){w(this,".press-scrollbar").then((e=>{e&&(this.zonesBox={top:e.top,bottom:e.bottom,height:e.height})}))},updatePopoverTipPosition(){w(this,`#seq-${this.innerCurrent}`).then((e=>{e&&(this.tipOffset=e.top-this.zonesBox.top+e.height/2)}))},scroll(e){s()?this.old.scrollTop=e.target.scrollTop:this.old.scrollTop=e.detail.scrollTop,this.updatePopoverTipPosition()},scrollTo(){const{autoScroll:e}=this;this.scrollToView=`seq-${this.innerCurrent}`,this.scrollTop=this.old.scrollTop,Promise.all([_(this,"#zoneBox"),w(this,`#seq-${this.innerCurrent}`)]).then((([t,o])=>{if(!o)return;const{top:s,bottom:n,height:l=0}=this.zonesBox;if(l>0){if(o.top-s<e*o.height)this.scrollTop=Math.max(1,(this.innerCurrent-1-e)*o.height);else if(n-o.bottom<e*o.height){const s=(this.innerCurrent+e)*o.height-l;this.scrollTop=Math.min(s,t.scrollHeight-l)}this.updatePopoverTipPosition()}}))},handleSelect(e){A&&(clearTimeout(A),A=null),this.selectedEvent=!0,this.innerCurrent!==e&&(this.innerCurrent=e,this.$emit("change",e)),this.scrollTo(),A=setTimeout((()=>{this.selectedEvent=!1}),500)}}},[["render",function(e,t,o,s,n,f){const P=p,y=u("PressPopoverPlus");return h(),l("div",{class:c(["press-pagination",[e.customClass,{"press-pagination--safe":e.safeAreaInsetBottom},{"press-pagination--hor":"hor"===e.mode}]])},[f.pageList.length>1?(h(),l("div",{key:0,class:"press-pagination__wrap"},[r(P,{id:"zoneBox",class:c(["press-scrollbar","press-scrollbar--active"]),"scroll-y":"true","scroll-with-animation":"","enable-flex":!0,"scroll-top":n.scrollTop,onScroll:f.scroll},{default:i((()=>[(h(!0),l(d,null,m(f.pageList,((t,o)=>(h(),l("div",{id:"seq-"+t,key:o,class:c(["press-scrollbar__scale",[{"press-scrollbar__scale--selected":n.innerCurrent===t},`press-scrollbar__scale--total-${e.total}`]]),onClick:e=>f.handleSelect(t,o)},[g("span",null,x(t),1)],10,["id","onClick"])))),128))])),_:1},8,["scroll-top","onScroll"]),r(y,{show:n.selectedEvent,placement:"left","custom-style":f.tipStyle},{default:i((()=>[g("p",null,x(f.pageTip),1)])),_:1},8,["show","custom-style"])])):a("",!0)],2)}],["__scopeId","data-v-9c5eba5b"]]),H=(e,t,o)=>({number:e,text:t,active:o});const O=e({components:{PressPaginationNext:e({name:"PressPaginationNext",props:{...M,...L},emits:["change"],data:()=>({}),computed:{count(){const{total:e,totalItems:t,itemsPerPage:o}=this,s=+e||Math.ceil(+t/+o);return Math.max(1,s)},pages(){const e=[],t=this.count,o=+this.showPageSize,{current:s,forceEllipses:n}=this;let l=1,a=t;const r=o<t;r&&(l=Math.max(s-Math.floor(o/2),1),a=l+o-1,a>t&&(a=t,l=a-o+1));for(let i=l;i<=a;i++){const t=H(i,i,i===s);e.push(t)}if(r&&o>0&&n){if(l>1){const t=H(l-1,"...");e.unshift(t)}if(a<t){const t=H(a+1,"...");e.push(t)}}return e}},methods:{bem2:f,updateModelValue(e){e=P(e,1,this.count),this.current!==e&&this.$emit("change",e)}}},[["render",function(e,t,o,s,n,a){return h(),l("div",{class:c(["press-pagination",e.customClass])},[g("div",{class:"press-pagination__items"},[g("div",{class:c([a.bem2("pagination__item",{disabled:1===e.current,border:"simple"===e.mode,prev:!0})])},[g("div",{disabled:1===e.current,onClick:t[0]||(t[0]=y((()=>a.updateModelValue(e.current-1)),["stop"]))},[C(e.$slots,"prev-text",{},(()=>[b(x(e.prevText),1)]),!0)],8,["disabled"])],2),"simple"===e.mode?(h(),l("div",{key:0,class:"press-pagination__page-desc"},x(`${e.current}/${a.count}`),1)):(h(!0),l(d,{key:1},m(a.pages,((t,o)=>(h(),l("div",{key:o,class:c([a.bem2("pagination__item",{active:t.active,page:!0}),"press-hairline--surround"]),onClick:y((()=>a.updateModelValue(t.number)),["stop"])},[g("div",null,[C(e.$slots,"page",{number:t.number,active:t.active,text:t.text},(()=>[b(x(t.text),1)]),!0)])],10,["onClick"])))),128)),g("div",{class:c([a.bem2("pagination__item",{disabled:e.current===a.count,border:"simple"===e.mode,next:!0})])},[g("div",{disabled:e.current===a.count,onClick:t[1]||(t[1]=y((()=>a.updateModelValue(e.current+1)),["stop"]))},[C(e.$slots,"next-text",{},(()=>[b(x(e.nextText),1)]),!0)],8,["disabled"])],2)])],2)}],["__scopeId","data-v-46ede55a"]]),PressPaginationESport:D},props:{...$,...M,...L},data:()=>({}),methods:{onChange(...e){this.$emit("change",...e)}}},[["render",function(e,t,o,s,n,l){const a=u("PressPaginationNext"),r=u("PressPaginationESport");return"multi"===e.mode||"simple"===e.mode?(h(),v(a,{key:0,mode:e.mode,total:e.total,current:e.current,"custom-class":e.customClass,"prev-text":e.prevText,"next-text":e.nextText,"total-items":e.totalItems,"show-page-size":e.showPageSize,"items-per-page":e.itemsPerPage,"force-ellipses":e.forceEllipses,"show-prev-button":e.showPrevButton,"show-next-button":e.showNextButton,onChange:l.onChange},{"next-text":i((()=>[C(e.$slots,"next-text")])),"prev-text":i((()=>[C(e.$slots,"prev-text")])),page:i((({number:t,active:o,text:s})=>[C(e.$slots,"page",{number:t,active:o,text:s})])),_:3},8,["mode","total","current","custom-class","prev-text","next-text","total-items","show-page-size","items-per-page","force-ellipses","show-prev-button","show-next-button","onChange"])):(h(),v(r,{key:1,mode:e.mode,total:e.total,current:e.current,"custom-class":e.customClass,expand:e.expand,"tip-template":e.tipTemplate,"auto-scroll":e.autoScroll,"safe-area-inset-bottom":e.safeAreaInsetBottom,onChange:l.onChange},null,8,["mode","total","current","custom-class","expand","tip-template","auto-scroll","safe-area-inset-bottom","onChange"]))}]]),U={pageTotal:30,current:2,expand:!1},j=Array.from({length:4}).map(((e,t)=>10**t)).reduce(((e,t)=>{for(let o=1;o<10;o++)e.push(t*o);return e}),[]).map((e=>({label:e,value:e})));const F=e({i18n:{"zh-CN":{title2:"简单模式",title3:"显示省略号",title4:"自定义按钮",prevText:"上一页",nextText:"下一页"},"en-US":{title2:"Simple Mode",title3:"Show ellipses",title4:"Custom Button",prevText:"Prev",nextText:"Next"}},components:{PressPagination:O,PressPopupCell:k,PressPickerPlus:B,PressCell:S,PressIcon:T},data(){const e={...U};return{sectionStyle:"margin: 0;background: #f7f8fa;",backgroundStyle:"background: #f7f8fa;",FUNCTIONAL_ID_MAP:E,mode:"",componentConfig:e,currentPage1:1,currentPage2:1,currentPage3:1,currentPage4:1}},methods:{onShowBasicPopupCell(){const{pageTotal:e,current:t}=this.componentConfig;!function({context:e,callback:t,pageTotal:o,current:s,isHor:n}){N({context:e,title:"自定义设置",closeIcon:!0,cellList:[{label:"页面数",value:o,click:({context:s})=>{s.closeDialog(),z({title:"页面数",closeIcon:!0,list:j,current:{value:o},context:e}).then((({item:o})=>{U.pageTotal=o.value,e.onGTip("设置成功"),"function"==typeof t.changePageTotal&&t.changePageTotal.call(e,o.value)})).catch((()=>{}))}},{label:"当前页",value:s,click:({context:n})=>{n.closeDialog(),z({title:"当前页",closeIcon:!0,list:j.filter((e=>e.value<=o)),current:{value:s},context:e}).then((({item:o})=>{U.current=o.value,e.onGTip("设置成功"),"function"==typeof t.changeCurrent&&t.changeCurrent.call(e,o.value)})).catch((()=>{}))}},{label:"是否为Hor模式",type:"switch",open:n,click:({context:o})=>{o.closeDialog(),e.onGTip("设置成功"),"function"==typeof t.changeHor&&t.changeHor.call(e,!n)}}]})}({context:this,callback:{changePageTotal:this.changePageTotal,changeCurrent:this.changeCurrent,changeHor:this.changeHor},pageTotal:e,current:t,isHor:"hor"===this.mode})},changeExpand(e){this.componentConfig={...this.componentConfig,expand:e}},changePageTotal(e){this.componentConfig={...this.componentConfig,pageTotal:e},this.componentConfig.current>e&&(this.componentConfig.current=e)},changeCurrent(e){this.componentConfig={...this.componentConfig,current:e}},changeHor(e){this.mode=e?"hor":""},onChange(e){console.log("[onChange]",e),this.componentConfig.current=e}}},[["render",function(e,t,o,s,n,a){const c=u("PressPagination"),p=u("demo-block"),d=u("PressIcon"),m=u("PressCell"),g=u("PressPopupCell"),f=u("PressPickerPlus");return h(),l("div",{class:"demo-wrap demo-wrap--gray"},[r(p,{title:e.t("basicUsage"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[r(c,{current:n.currentPage1,mode:"multi","total-items":24,"items-per-page":5,"prev-text":e.t("prevText"),"next-text":e.t("nextText"),onChange:t[0]||(t[0]=e=>n.currentPage1=e)},null,8,["current","prev-text","next-text"])])),_:1},8,["title","section-style","header-style","custom-style"]),r(p,{title:e.t("title2"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[r(c,{current:n.currentPage2,total:12,"prev-text":e.t("prevText"),"next-text":e.t("nextText"),mode:"simple",size:"small",onChange:t[1]||(t[1]=e=>n.currentPage2=e)},null,8,["current","prev-text","next-text"])])),_:1},8,["title","section-style","header-style","custom-style"]),r(p,{title:e.t("title3"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[r(c,{mode:"multi",current:n.currentPage3,"force-ellipses":"","total-items":125,"show-page-size":3,"prev-text":e.t("prevText"),"next-text":e.t("nextText"),onChange:t[2]||(t[2]=e=>n.currentPage3=e)},null,8,["current","prev-text","next-text"])])),_:1},8,["title","section-style","header-style","custom-style"]),r(p,{title:e.t("title4"),"section-style":n.backgroundStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[r(c,{mode:"multi",current:n.currentPage4,"total-items":125,"show-page-size":5,onChange:t[3]||(t[3]=e=>n.currentPage4=e)},{"prev-text":i((()=>[r(d,{name:"arrow-left"})])),"next-text":i((()=>[r(d,{name:"arrow"})])),page:i((({text:e})=>[b(x(e),1)])),_:1},8,["current"])])),_:1},8,["title","section-style","header-style","custom-style"]),r(p,{title:"E-Sport","section-style":n.sectionStyle,"header-style":n.backgroundStyle,"custom-style":n.backgroundStyle},{default:i((()=>[r(m,{title:e.t("custom"),"is-link":"",onClick:a.onShowBasicPopupCell},null,8,["title","onClick"])])),_:1},8,["section-style","header-style","custom-style"]),r(g,{id:n.FUNCTIONAL_ID_MAP.POPUP_CELL,ref:n.FUNCTIONAL_ID_MAP.POPUP_CELL,mode:"functional"},null,8,["id"]),r(f,{id:n.FUNCTIONAL_ID_MAP.PICKER,ref:n.FUNCTIONAL_ID_MAP.PICKER,mode:"functional"},null,8,["id"]),r(c,{total:n.componentConfig.pageTotal,current:n.componentConfig.current,expand:n.componentConfig.expand,mode:n.mode,onChange:a.onChange},null,8,["total","current","expand","mode","onChange"])])}]]);export{F as default};
